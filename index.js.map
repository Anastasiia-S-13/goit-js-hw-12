{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from \"axios\";\nimport { perPage } from \"../main\";\n\nconst API_KEY = '51396657-6a58d607ccd7d0682078fb53f';\naxios.defaults.baseURL = 'https://pixabay.com/api/';\n\nexport async function getImagesByQuery(query, page) {\n    const params = new URLSearchParams({\n        page: page,\n        per_page: perPage\n    });\n\n    const response = await axios.get(`?key=${API_KEY}&q=${query}&image_type=photo&orientation=horizontal&safesearch&${params}`);\n    return response.data;\n}","import { list, loader, btnLoadMore } from \"../main\"; \nimport SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\n\nlet lightbox;\n\nexport function createGallery(images) {\n    const galleryMarkup = images.map(({ webformatURL, largeImageURL, tags, likes, views, comments, downloads, id }) => {\n        return `\n        <li class=\"list-item\">\n            <a class=\"list-link\" href=\"${largeImageURL}\">\n                <img data-id=\"${id}\" class=\"image-item\" alt=\"${tags}\" src=\"${webformatURL}\">\n                <ul class=\"description\">\n                        <li class=\"desc-item\">\n                            <p class=\"figcaption\">Likes<span class=\"caption-span\">${likes}</span></p>\n                        </li>\n                        <li class=\"desc-item\">\n                            <p class=\"figcaption\">Views<span class=\"caption-span\">${views}</span></p>\n                        </li>\n                        <li class=\"desc-item\">\n                            <p class=\"figcaption\">Comments<span class=\"caption-span\">${comments}</span></p>\n                        </li>\n                        <li class=\"desc-item\">\n                            <p class=\"figcaption\">Downloads<span class=\"caption-span\">${downloads}</span></p>\n                        </li>\n                    </ul>\n            </a>\n        </li>\n        `\n    }).join(\"\");\n    list.insertAdjacentHTML(\"beforeend\", galleryMarkup);\n    if (lightbox) {\n                lightbox.refresh();\n            } else {\n                lightbox = new SimpleLightbox('.gallery a', {\n                    captions: true,\n                    captionSelector: 'img',\n                    captionsData: 'alt',\n                    captionPosition: 'bottom',\n                    captionDelay: 250,\n                    fadeSpeed: 100,\n                })\n            }\n};\n\n\nexport function clearGallery() {\n    list.innerHTML = \"\";\n}\n\n\nexport function showLoader() {\n    loader.classList.remove(\"hidden\");\n}\n\nexport function hideLoader() {\n    loader.classList.add(\"hidden\");\n}\n\nexport function showLoadMoreButton() {\n    btnLoadMore.classList.remove(\"hidden\");\n}\nexport function hideLoadMoreButton() {\n    btnLoadMore.classList.add(\"hidden\");\n}","import { getImagesByQuery } from \"./js/pixabay-api.js\";\nimport {createGallery, hideLoader, clearGallery, showLoader, showLoadMoreButton, hideLoadMoreButton } from \"./js/render-functions.js\";\n\nimport iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\n\nexport const form = document.querySelector(\".form\");\nexport const input = document.querySelector(\".search-input\");\nexport const list = document.querySelector(\".gallery\");\nexport const loader = document.querySelector(\".loader\");\nexport const btnLoadMore = document.querySelector(\".load-more\");\n\nexport let perPage = 15;\nlet page = 1;\nlet totalPages = 0;\nlet chosedName = \"\";\n\ndocument.addEventListener(\"DOMContentLoaded\", () => {\n    hideLoader();\n});\nform.addEventListener(\"submit\", handleSubmit);\n\nasync function handleSubmit(event) {\n    try {\n        event.preventDefault();\n        chosedName = input.value.trim().toLowerCase();\n        if (!chosedName) {\n            iziToast.error({\n                message: 'Sorry, there are no images matching your search query. Please try again!',\n            });\n            return;\n        };\n        page = 1;\n        clearGallery();\n        hideLoadMoreButton();\n        showLoader();\n        const data = await getImagesByQuery(chosedName, page);\n        if (!data.hits.length) {\n            iziToast.error({\n                message: 'Sorry, there are no images matching your search query. Please try again!'\n            });\n            hideLoader();\n            return;\n        }\n        totalPages = Math.ceil(data.totalHits / perPage);\n        createGallery(data.hits);\n        if (data.totalHits > perPage) {\n            showLoadMoreButton();\n        } else {\n            hideLoadMoreButton();\n        };\n        form.reset();\n        hideLoader();\n        \n    } catch(error) {\n                iziToast.error({\n                    message: 'Sorry, there are no images matching your search query. Please try again!',\n                });\n                console.log(error);\n            };\n};\n\nbtnLoadMore.addEventListener(\"click\", async () => {\n    hideLoadMoreButton();\n    if (page >= totalPages) {\n        hideLoadMoreButton();\n        return iziToast.warning({\n            position: \"topRight\",\n            message: \"We're sorry, but you've reached the end of search results.\"\n        })\n    }\n\n    showLoader();\n    await new Promise(resolve => requestAnimationFrame(resolve)); \n\n    try {\n        page += 1;\n        const data = await getImagesByQuery(chosedName, page);\n        totalPages = Math.ceil(data.totalHits / perPage);\n        createGallery(data.hits);\n        showLoadMoreButton();\n        hideLoader();\n        const lastItem = list.lastElementChild;\n\n        if (lastItem) {\n            const elemHeight = lastItem.getBoundingClientRect().height;\n            scrollBy({\n                top: elemHeight * 2,\n                behavior: \"smooth\"\n            });\n        };\n\n        if (page >= totalPages) {\n            hideLoadMoreButton();\n            return iziToast.warning({\n                position: \"topRight\",\n                message: \"We're sorry, but you've reached the end of search results.\"\n            })\n        }\n    } catch (error) {\n        console.log(error);\n        hideLoader();\n    }\n});"],"names":["API_KEY","axios","getImagesByQuery","query","page","params","perPage","lightbox","createGallery","images","galleryMarkup","webformatURL","largeImageURL","tags","likes","views","comments","downloads","id","list","SimpleLightbox","clearGallery","showLoader","loader","hideLoader","showLoadMoreButton","btnLoadMore","hideLoadMoreButton","form","input","totalPages","chosedName","handleSubmit","event","iziToast","data","error","resolve","lastItem","elemHeight"],"mappings":"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"}